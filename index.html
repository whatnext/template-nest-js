<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>template-nest.js</title>
        <script src='/template-nest.js'></script>
    </head>
    <body>
        <script>
         const simple_page = {
             "TEMPLATE": "00-simple-page",
             "variable": "Simple Variable",
             "simple_component": {
                 "TEMPLATE": "01-simple-component",
                 "variable": "Simple Variable in Simple Component"
             }
         };

         const incomplete_page = {
             "TEMPLATE": "00-simple-page",
             "variable": "Simple Variable",
             "simple_component": {
                 "TEMPLATE": "01-simple-component",
             }
         };

         const complex_page = {
             "TEMPLATE": "10-complex-page",
             "title": "Complex Page",
             "pre_body": {
                 "TEMPLATE": "18-styles",
             },
             "navigation": {
                 "TEMPLATE": "11-navigation",
                 "banner": {
                     "TEMPLATE": "12-navigation-banner",
                 },
                 "items": [
                     { "TEMPLATE": "13-navigation-item-00-services" },
                     { "TEMPLATE": "13-navigation-item-01-resources" },
                 ]
             },
             "hero_section": {
                 "TEMPLATE": "14-hero-section",
             },
             "main_content": [
                 { "TEMPLATE": "15-isdc-card", },
                 {
                     "TEMPLATE": "16-vb-brand-cards",
                     "cards": [
                         {
                             "TEMPLATE": "17-vb-brand-card-00",
                             "parent_classes": "p-card brand-card col-4",
                         },
                         {
                             "TEMPLATE": "17-vb-brand-card-01",
                             "parent_classes": "p-card brand-card col-4",
                         },
                         {
                             "TEMPLATE": "17-vb-brand-card-02",
                             "parent_classes": "p-card brand-card col-4",
                         },
                     ]
                 }
             ],
             "post_footer": {
                 "TEMPLATE": "19-scripts"
             }
         };

         const array_of_hash = [
             {
                 "TEMPLATE": "01-simple-component",
                 "variable": "This is a variable",
             }, {
                 "TEMPLATE": "01-simple-component",
                 "variable": "This is another variable",
             }
         ];

         const show_label_page = {
             "TEMPLATE": "00-simple-page",
             "variable": "Simple Variable",
             "simple_component":  {
                 "TEMPLATE":"01-simple-component",
                 "variable": "Simple Variable in Simple Component"
             }
         };

         const nest = new TemplateNest({ template_dir: "/templates" });
         const nest_label = new TemplateNest({
             template_dir: "/templates",
             show_labels: true
         });

         const pages = [
             {
                 "name": "simple_page",
                 "page_render": nest.render(simple_page),
                 "output": nest.render({ "TEMPLATE": "output/01-simple-page" }),
             }, {
                 "name": "incomplete_page",
                 "page_render": nest.render(incomplete_page),
                 "output": nest.render({ "TEMPLATE": "output/03-incomplete-page" }),
             }, {
                 "name": "complex_page",
                 "page_render": nest.render(complex_page),
                 "output": nest.render({ "TEMPLATE": "output/02-complex-page" }),
             }, {
                 "name": "array_of_hash",
                 "page_render": nest.render(array_of_hash),
                 "output": nest.render({ "TEMPLATE": "output/13-render-with-array-of-template-hash" }),
             }, {
                 "name": "show_label_page",
                 "page_render": nest_label.render(show_label_page),
                 "output": nest.render({ "TEMPLATE": "output/04-simple-page-with-labels" }),
             },
         ];

         for (const page of pages) {
             (async() => {
                 const rendered_output = await page["page_render"];
                 const output = await page["output"];

                 if (rendered_output === output)
                     console.log(`${page["name"]} pass`);
                 else {
                     console.error(`${page["name"]} fail`);
                     console.error(rendered_output);
                     console.error(output);
                 }

             })();
         }
        </script>
    </body>
</html>
